# 图解HTTP
上野宣


◆ 1.1 使用HTTP协议访问Web

> HTTP（HyperText Transfer Protocol，超文本传输协议[插图]）

◆ 1.7 URI和URL

> 有一些用来制定HTTP协议技术标准的文档，它们被称为RFC（Request for Comments，征求修正意见书）。

◆ 2.2 通过请求和响应的交换达成通信

> 响应报文基本上由协议版本、状态码（表示请求成功或失败的数字代码）、用以解释状态码的原因短语、可选的响应首部字段以及实体主体构成。

◆ 2.3 HTTP是不保存状态的协议

> HTTP是一种不保存状态，即无状态（stateless）协议。HTTP协议自身不对请求和响应之间的通信状态进行保存。

◆ 3.3 编码提升传输速率

> 通常，报文主体等于实体主体。只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异。

◆ 3.5 获取部分内容的范围请求

> 如果服务器端无法响应范围请求，则会返回状态码200 OK和完整的实体内容。

◆ 4.3 3XX重定向

> 当301、302、303响应状态码返回时，几乎所有的浏览器都会把POST改成GET，并删除请求报文内的主体，之后请求会自动再次发送。301、302标准是禁止将POST方法改变成GET方法的，但实际使用时大家都会这么做。

◆ 5.1 用单台虚拟主机实现多个域名

> 在相同的IP地址下，由于虚拟主机可以寄存多个不同主机名和域名的Web网站，因此在发送HTTP请求时，必须在Host首部内完整指定主机名或域名的URI。

◆ 5.2 通信数据转发程序：代理、网关、隧道

> 代理有多种使用方法，按两种基准分类。一种是是否使用缓存，另一种是是否会修改报文。

◆ 第6章 HTTP首部


◆ 6.1 HTTP报文首部

> 在请求中，HTTP报文由方法、URI、HTTP版本、HTTP首部字段等部分构成。

◆ 6.2 HTTP首部字段

> 使用首部字段是为了给浏览器和服务器提供报文主体大小、所使用的语言、认证信息等内容。

◆ 6.4 请求首部字段

> 首部字段Referer会告知服务器请求的原始资源的URI。

◆ 6.6 实体首部字段

> 实体首部字段是包含在请求报文和响应报文中的实体部分所使用的首部，用于补充内容的更新时间等与实体相关的信息。

◆ 7.1 HTTP的缺点

> HTTP主要有这些不足，例举如下。●通信使用明文（不加密），内容可能会被窃听●不验证通信方的身份，因此有可能遭遇伪装●无法证明报文的完整性，所以有可能已遭篡改

> HTTP协议中没有加密机制，但可以通过和SSL（Secure Socket Layer，安全套接层）或TLS（Transport Layer Security，安全传输层协议）的组合使用，加密HTTP的通信内容。

◆ 7.2 HTTP+加密+认证+完整性保护=HTTPS

> SSL是独立于HTTP的协议，所以不光是HTTP协议，其他运行在应用层的SMTP和Telnet等协议均可配合SSL协议使用。可以说SSL是当今世界上应用最为广泛的网络安全技术。

> SSL的慢分两种。一种是指通信慢。另一种是指由于大量消耗CPU及内存等资源，导致处理速度变慢。

◆ 9.2 消除HTTP瓶颈的SPDY

> Google在2010年发布了SPDY（取自SPeeDY，发音同speedy），其开发目标旨在解决HTTP的性能瓶颈，缩短Web页面的加载时间（50%）。

> Ajax的核心技术是名为XMLHttpRequest的API，通过JavaScript脚本语言的调用就能和服务器进行HTTP通信。借由这种手段，就能从已加载完毕的Web页面上发起请求，只更新局部页面。

> 另外，Comet也仍未解决HTTP协议本身存在的问题

> SPDY协议

> 有好几家Web浏览器已经针对SPDY做出了相应的调整。另外，Web服务器也进行了实验性质的应用，但把该技术导入实际的Web网站却进展不佳。

◆ 9.3 使用浏览器进行全双工通信的WebSocket

> WebSocket网络技术正是为解决这些问题而实现的一套新协议及API。

◆ 10.2 动态HTML

> 所谓动态HTML（Dynamic HTML），是指使用客户端脚本语言将静态的HTML内容变成动态的技术的总称。

◆ 10.3 Web应用

> CGI（Common Gateway Interface，通用网关接口）是指Web服务器在接收到客户端发送过来的请求后转发给程序的一组机制。

> 之前提及的CGI，由于每次接到请求，程序都要跟着启动一次。因此一旦访问量过大，Web服务器要承担相当大的负载。而Servlet运行在与Web服务器相同的进程中，因此受到的负载较小[插图]。Servlet的运行环境叫做Web容器或Servlet容器

◆ 10.4 数据发布的格式及语言

> XML（eXtensible Markup Language，可扩展标记语言）是一种可按应用目标进行扩展的通用标记语言。旨在通过使用XML，使互联网数据共享变得更容易。

> XML和HTML一样，使用标签构成树形结构，并且可自定义扩展标签。从XML文档中读取数据比起HTML更为简单。由于XML的结构基本上都是用标签分割而成的树形结构，因此通过语法分析器（Parser）的解析功能解析XML结构并取出数据元素，可更容易地对数据进行读取。

> RSS（简易信息聚合，也叫聚合内容）和Atom都是发布新闻或博客日志等更新信息文档的格式的总称。两者都用到了XML。

> JSON（JavaScript Object Notation）是一种以JavaScript（ECMAScript）的对象表示法为基础的轻量级数据标记语言。能够处理的数据类型有false/null/true/对象/数组/数字/字符串，这7种类型。

> JSON让数据更轻更纯粹，并且JSON的字符串形式可被JavaScript轻易地读入。当初配合XML使用的Ajax技术也让JSON的应用变得更为广泛。另外，其他各种编程语言也提供丰富的库类，以达到轻便操作JSON的目的。

◆ 11.1 针对Web的攻击技术

> 应用HTTP协议的服务器和客户端，以及运行在服务器上的Web应用等资源才是攻击目标。

> 主动攻击模式里具有代表性的攻击是SQL注入攻击和OS命令注入攻击。

> b应用会成为攻击者的跳板，可能导致用户所持的Cookie等个人信息被窃取，登录状态中的用户权限遭恶意滥用等后果。

◆ 11.2 因输出值转义不完全引发的安全漏洞

> 不适合将JavaScript验证作为安全的防范对策。保留客户端验证只是为了尽早地辨识输入错误，起到提高UI体验的作用

> SQL注入（SQL Injection）是指针对Web应用使用的数据库，通过运行非法的SQL而产生的攻击。

> HTTP首部注入攻击（HTTP Header Injection）是指攻击者通过在响应首部字段内插入换行，添加任意响应首部或主体的一种攻击。属于被动攻击模式。

> 目录遍历（Directory Traversal）攻击是指对本无意公开的文件目录，通过非法截断其目录路径后，达成访问目的的一种攻击。这种攻击有时也称为路径遍历（Path Traversal）攻击。

◆ 11.3 因设置或设计上的缺陷引发的安全漏洞

> 对那些原本不愿公开的文件，为了保证安全会隐蔽其URL。可一旦知道了那些URL，也就意味着可浏览URL对应的文件。直接显示容易推测的文件名或文件目录索引时，通过某些方法可能会使URL产生泄露。

> 可信度高的Web网站如果开放重定向功能，则很有可能被攻击者选中并用来作为钓鱼攻击的跳板。

◆ 11.4 因会话管理疏忽引发的安全漏洞

> 图：会话固定攻击案例

> 攻击者估计用户差不多已触发陷阱后，再利用之前这个会话ID访问网站。由于该会话ID目前已是（用户A已认证）状态，于是攻击者作为用户A的身份顺利登录网站。

◆ 11.5 其他安全漏洞

> 密码破解有以下两种手段。●通过网络的密码试错● 对已加密密码的破解（指攻击者入侵系统，已获得加密或散列处理的密码数据的情况）
